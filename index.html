<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Dragon Pop</title>
    <link rel="stylesheet" type="text/css" href="application.css">
    <script type="text/javascript" src="./assets/jquery-2.1.1.js"></script>
  </head>
  <body>
    <script src="lib/gameView.js"></script>
    <script src="lib/game.js"></script>
    <script src="lib/bubble.js"></script>
    <script src="lib/dragon.js"></script>
    <script src="lib/fireball.js"></script>
    <script src="lib/firewall.js"></script>

    <h1>Dragon Pop</h1>

    <div id="controls" class="group">
      <div>MOVE: LEFT/RIGHT ARROW</div>
      <br>
      <div>FIREBALL: SPACEBAR</div>
    </div>
    <div id="game-container">
      <div id="options">
        <div>
          <div id="options-header">CHOOSE YOUR DRAGON</div>
          <div id="dragon-options">
            <div class="orange dragon-option">
              <img id="orange-dragon" src="assets/orange-dragon-2.gif"/>
              <label>Brabiant</label>
            </div>
            <div class="green dragon-option">
              <img id="green-dragon" src="assets/green-dragon-2.gif"/>
              <label>Whyerz</label>
            </div>
            <div class="white dragon-option">
              <img id="white-dragon" src="assets/white-dragon-2.gif"/>
              <label>Roondris</label>
            </div>
          </div>
        </div>
        <div>
          <div id="options-header">CHOOSE FIRE COLOR</div>
          <div id="fire-options">
            <div class="orange fire-option">
              <img id="orange-fire" src="assets/orange-fire-2.gif"/>
              <label>ORANGE</label>
            </div>
            <div class="green fire-option">
              <img id="green-fire" src="assets/green-fire-2.gif"/>
              <label>GREEN</label>
            </div>
            <div class="blue fire-option">
              <img id="blue-fire" src="assets/blue-fire-2.gif"/>
              <label>BLUE</label>
            </div>
          </div>
        </div>
        <div id="play-game"><span>START GAME<span></div>
      </div>
      <canvas id="game-canvas" width="600" height="400"></canvas>
    </div>



    <script>
     var canvas = document.getElementById("game-canvas");
     var ctx = canvas.getContext("2d");
     window.DRAGON = "orange";
     window.FIRE = "orange";

     setTimeout(function() {
       var tile = new Image();
       tile.src = "assets/stone.png";
       var pattern = ctx.createPattern(tile, "repeat");
       ctx.fillStyle = pattern;
       ctx.fillRect(0, 0, 600, 400);
     }, 0);

     requestAnimFrame = (function() {
       return window.requestAnimationFrame       ||
              window.webkitRequestAnimationFrame ||
              window.mozRequestanimationFrame    ||
              function(callback){
                window.setTimeout(callback, 1000 / 60);
              };
     })();
   </script>

   <script>
    $(function() {
      $("#orange-dragon").hover(
        function() { $(this).attr("src", "assets/orange-dragon.gif"); },
        function() { $(this).attr("src", "assets/orange-dragon-2.gif"); }
      );
    });
    $(function() {
      $("#green-dragon").hover(
        function() { $(this).attr("src", "assets/green-dragon.gif"); },
        function() { $(this).attr("src", "assets/green-dragon-2.gif"); }
      );
    });
    $(function() {
      $("#white-dragon").hover(
        function() { $(this).attr("src", "assets/white-dragon.gif"); },
        function() { $(this).attr("src", "assets/white-dragon-2.gif"); }
      );
    });
    $(function() {
      $("#orange-fire").hover(
        function() { $(this).attr("src", "assets/orange-fire.gif"); },
        function() { $(this).attr("src", "assets/orange-fire-2.gif"); }
      );
    });
    $(function() {
      $("#green-fire").hover(
        function() { $(this).attr("src", "assets/green-fire.gif"); },
        function() { $(this).attr("src", "assets/green-fire-2.gif"); }
      );
    });
    $(function() {
      $("#blue-fire").hover(
        function() { $(this).attr("src", "assets/blue-fire.gif"); },
        function() { $(this).attr("src", "assets/blue-fire-2.gif"); }
      );
    });
    $(function() {
      $(".dragon-option").click(function() {
        $(".dragon-select").removeClass("dragon-select");
        $(this).addClass("dragon-select");
        if ($(this).hasClass("white")) {
          window.DRAGON = "white";
        } else if ($(this).hasClass("orange")) {
          window.DRAGON = "orange";
        } else {
          window.DRAGON = "green";
        }
      })
    })
    $(function() {
      $(".fire-option").click(function() {
        $(".fire-select").removeClass("fire-select");
        $(this).addClass("fire-select");
        if ($(this).hasClass("blue")) {
          window.FIRE = "blue";
        } else if ($(this).hasClass("orange")) {
          window.FIRE = "orange";
        } else {
          window.FIRE = "green";
        }
      })
    })
    $(function() {
      $("#play-game").click(function() {
        $("#options").fadeOut(1500);
        setTimeout(function() {
          var gameView = new BubbleGame.GameView(new BubbleGame.Game(), ctx);
          function mainLoop() {
            requestAnimFrame(mainLoop);
            gameView.render();
          }
          requestAnimFrame(mainLoop);
        }, 3000);
      });
    });
    </script>
  </body>
</html>
